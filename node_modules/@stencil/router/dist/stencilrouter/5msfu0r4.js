/*! Built with http://stenciljs.com */
const{h:t}=window.stencilrouter;class e{componentWillLoad(){const t=this.activeRouter&&this.activeRouter.get("titleSuffix")||"";document.title=`${this.title}${t}`}render(){return null}static get is(){return"stencil-route-title"}static get properties(){return{activeRouter:{context:"activeRouter"},title:{type:String,attr:"title"}}}}function n(t,e){return new RegExp("^"+e+"(\\/|\\?|#|$)","i").test(t)}function o(t,e){return n(t,e)?t.substr(e.length):t}function i(t){return"/"===t.charAt(t.length-1)?t.slice(0,-1):t}function r(t){return"/"===t.charAt(0)?t:"/"+t}function s(t){return"/"===t.charAt(0)?t.substr(1):t}function a(t){const{pathname:e,search:n,hash:o}=t;let i=e||"/";return n&&"?"!==n&&(i+="?"===n.charAt(0)?n:`?${n}`),o&&"#"!==o&&(i+="#"===o.charAt(0)?o:`#${o}`),i}function c(t){return"/"===t.charAt(0)}function l(t,e){for(let n=e,o=n+1,i=t.length;o<i;n+=1,o+=1)t[n]=t[o];t.pop()}function u(t,e,n,o){let i;"string"==typeof t?(i=function(t){let e=t||"/",n="",o="";const i=e.indexOf("#");-1!==i&&(o=e.substr(i),e=e.substr(0,i));const r=e.indexOf("?");return-1!==r&&(n=e.substr(r),e=e.substr(0,r)),{pathname:e,search:"?"===n?"":n,hash:"#"===o?"":o}}(t)).state=e:(void 0===(i=Object.assign({},t)).pathname&&(i.pathname=""),i.search?"?"!==i.search.charAt(0)&&(i.search="?"+i.search):i.search="",i.hash?"#"!==i.hash.charAt(0)&&(i.hash="#"+i.hash):i.hash="",void 0!==e&&void 0===i.state&&(i.state=e));try{i.pathname=decodeURI(i.pathname)}catch(t){throw t instanceof URIError?new URIError('Pathname "'+i.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):t}var r;return n&&(i.key=n),o?i.pathname?"/"!==i.pathname.charAt(0)&&(i.pathname=function(t,e=""){const n=t&&t.split("/")||[];let o=e&&e.split("/")||[];const i=t&&c(t),r=e&&c(e),s=i||r;if(t&&c(t)?o=n:n.length&&(o.pop(),o=o.concat(n)),!o.length)return"/";let a;if(o.length){const t=o[o.length-1];a="."===t||".."===t||""===t}else a=!1;let u=0;for(let t=o.length;t>=0;t--){const e=o[t];"."===e?l(o,t):".."===e?(l(o,t),u++):u&&(l(o,t),u--)}if(!s)for(;u--;u)o.unshift("..");!s||""===o[0]||o[0]&&c(o[0])||o.unshift("");let h=o.join("/");return a&&"/"!==h.substr(-1)&&(h+="/"),h}(i.pathname,o.pathname)):i.pathname=o.pathname:i.pathname||(i.pathname="/"),i.query=(r=i.search)?(/^[?#]/.test(r)?r.slice(1):r).split("&").reduce((t,e)=>{let[n,o]=e.split("=");return t[n]=o?decodeURIComponent(o.replace(/\+/g," ")):"",t},{}):{},i}function h(t,...e){t||console.error(...e)}function d(t,...e){t||console.warn(...e)}const p=()=>{let t,e=[];return{setPrompt:e=>(d(null==t,"A history supports only one prompt at a time"),t=e,()=>{t===e&&(t=null)}),confirmTransitionTo:(e,n,o,i)=>{if(null!=t){const r="function"==typeof t?t(e,n):t;"string"==typeof r?"function"==typeof o?o(r,i):(d(!1,"A history needs a getUserConfirmation function in order to use a prompt message"),i(!0)):i(!1!==r)}else i(!0)},appendListener:t=>{let n=!0;const o=(...e)=>{n&&t(...e)};return e.push(o),()=>{n=!1,e=e.filter(t=>t!==o)}},notifyListeners:(...t)=>{e.forEach(e=>e(...t))}}},f=!("undefined"==typeof window||!window.document||!window.document.createElement),m=(t,e,n)=>t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n),g=(t,e,n)=>t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent("on"+e,n),w=(t,e)=>e(window.confirm(t)),y=()=>{try{return window.history.state||{}}catch(t){return{}}},b={hashbang:{encodePath:t=>"!"===t.charAt(0)?t:"!/"+s(t),decodePath:t=>"!"===t.charAt(0)?t.substr(1):t},noslash:{encodePath:s,decodePath:r},slash:{encodePath:r,decodePath:r}},v=()=>{const t=window.location.href,e=t.indexOf("#");return-1===e?"":t.substring(e+1)},x=t=>{const e=window.location.href.indexOf("#");window.location.replace(window.location.href.slice(0,e>=0?e:0)+"#"+t)},k={browser:(t={})=>{h(f,"Browser history needs a DOM");const e=window.history,s=(()=>{const t=window.navigator.userAgent;return(-1===t.indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history})(),c=!(()=>-1===window.navigator.userAgent.indexOf("Trident"))(),{forceRefresh:l=!1,getUserConfirmation:b=w,keyLength:v=6}=t,x=t.basename?i(r(t.basename)):"",k=t=>{t=t||{};const{key:e,state:i}=t,{pathname:r,search:s,hash:a}=window.location;let c=r+s+a;return d(!x||n(c,x),'You are attempting to use a basename on a page whose URL path does not begin with the basename. Expected path "'+c+'" to begin with "'+x+'".'),x&&(c=o(c,x)),u(c,i,e)},O=()=>Math.random().toString(36).substr(2,v),R=p(),P=t=>{Object.assign(B,t),B.length=e.length,R.notifyListeners(B.location,B.action)},L=t=>{(t=>void 0===t.state&&-1===navigator.userAgent.indexOf("CriOS"))(t)||T(k(t.state))},A=()=>{T(k(y()))};let S=!1;const T=t=>{if(S)S=!1,P();else{const e="POP";R.confirmTransitionTo(t,e,b,n=>{n?P({action:e,location:t}):E(t)})}},E=t=>{const e=B.location;let n=U.indexOf(e.key);-1===n&&(n=0);let o=U.indexOf(t.key);-1===o&&(o=0);const i=n-o;i&&(S=!0,C(i))},j=k(y());let U=[j.key];const D=t=>x+a(t),C=t=>{e.go(t)};let H=0;const M=t=>{1===(H+=t)?(m(window,"popstate",L),c&&m(window,"hashchange",A)):0===H&&(g(window,"popstate",L),c&&g(window,"hashchange",A))};let I=!1;const B={length:e.length,action:"POP",location:j,createHref:D,push:(t,n)=>{d(!("object"==typeof t&&void 0!==t.state&&void 0!==n),"You should avoid providing a 2nd state argument to push when the 1st argument is a location-like object that already has state; it is ignored");const o=u(t,n,O(),B.location);R.confirmTransitionTo(o,"PUSH",b,t=>{if(!t)return;const n=D(o),{key:i,state:r}=o;if(s)if(e.pushState({key:i,state:r},null,n),l)window.location.href=n;else{const t=U.indexOf(B.location.key),e=U.slice(0,-1===t?0:t+1);e.push(o.key),U=e,P({action:"PUSH",location:o})}else d(void 0===r,"Browser history cannot push state in browsers that do not support HTML5 history"),window.location.href=n})},replace:(t,n)=>{d(!("object"==typeof t&&void 0!==t.state&&void 0!==n),"You should avoid providing a 2nd state argument to replace when the 1st argument is a location-like object that already has state; it is ignored");const o=u(t,n,O(),B.location);R.confirmTransitionTo(o,"REPLACE",b,t=>{if(!t)return;const n=D(o),{key:i,state:r}=o;if(s)if(e.replaceState({key:i,state:r},null,n),l)window.location.replace(n);else{const t=U.indexOf(B.location.key);-1!==t&&(U[t]=o.key),P({action:"REPLACE",location:o})}else d(void 0===r,"Browser history cannot replace state in browsers that do not support HTML5 history"),window.location.replace(n)})},go:C,goBack:()=>C(-1),goForward:()=>C(1),block:(t="")=>{const e=R.setPrompt(t);return I||(M(1),I=!0),()=>(I&&(I=!1,M(-1)),e())},listen:t=>{const e=R.appendListener(t);return M(1),()=>{M(-1),e()}}};return B},hash:(t={})=>{h(f,"Hash history needs a DOM");const e=window.history,s=(()=>-1===window.navigator.userAgent.indexOf("Firefox"))(),{getUserConfirmation:c=w,hashType:l="slash"}=t,y=t.basename?i(r(t.basename)):"",{encodePath:k,decodePath:P}=b[l],L=()=>{let t=P(v());return d(!y||n(t,y),'You are attempting to use a basename on a page whose URL path does not begin with the basename. Expected path "'+t+'" to begin with "'+y+'".'),y&&(t=o(t,y)),u(t)},A=p(),S=t=>{Object.assign(F,t),F.length=e.length,A.notifyListeners(F.location,F.action)};let T=!1,E=null;const j=()=>{const t=v(),e=k(t);if(t!==e)x(e);else{const t=L(),e=F.location;if(!T&&(R=t,(O=e).pathname===R.pathname&&O.search===R.search&&O.hash===R.hash&&O.key===R.key&&function t(e,n){if(e===n)return!0;if(null==e||null==n)return!1;if(Array.isArray(e))return Array.isArray(n)&&e.length===n.length&&e.every(function(e,o){return t(e,n[o])});const o=typeof e;if(o!==typeof n)return!1;if("object"===o){const o=e.valueOf(),i=n.valueOf();if(o!==e||i!==n)return t(o,i);const r=Object.keys(e),s=Object.keys(n);return r.length===s.length&&r.every(function(o){return t(e[o],n[o])})}return!1}(O.state,R.state)))return;if(E===a(t))return;E=null,U(t)}},U=t=>{if(T)T=!1,S();else{const e="POP";A.confirmTransitionTo(t,e,c,n=>{n?S({action:e,location:t}):D(t)})}},D=t=>{const e=F.location;let n=I.lastIndexOf(a(e));-1===n&&(n=0);let o=I.lastIndexOf(a(t));-1===o&&(o=0);const i=n-o;i&&(T=!0,B(i))},C=v(),H=k(C);C!==H&&x(H);const M=L();let I=[a(M)];const B=t=>{d(s,"Hash history go(n) causes a full page reload in this browser"),e.go(t)};let $=0;const W=t=>{1===($+=t)?m(window,"hashchange",j):0===$&&g(window,"hashchange",j)};let Y=!1;const F={length:e.length,action:"POP",location:M,createHref:t=>"#"+k(y+a(t)),push:(t,e)=>{d(void 0===e,"Hash history cannot push state; it is ignored");const n=u(t,void 0,void 0,F.location);A.confirmTransitionTo(n,"PUSH",c,t=>{if(!t)return;const e=a(n),o=k(y+e);if(v()!==o){E=e,(t=>window.location.hash=t)(o);const t=I.lastIndexOf(a(F.location)),i=I.slice(0,-1===t?0:t+1);i.push(e),I=i,S({action:"PUSH",location:n})}else d(!1,"Hash history cannot PUSH the same path; a new entry will not be added to the history stack"),S()})},replace:(t,e)=>{d(void 0===e,"Hash history cannot replace state; it is ignored");const n=u(t,void 0,void 0,F.location);A.confirmTransitionTo(n,"REPLACE",c,t=>{if(!t)return;const e=a(n),o=k(y+e);v()!==o&&(E=e,x(o));const i=I.indexOf(a(F.location));-1!==i&&(I[i]=e),S({action:"REPLACE",location:n})})},go:B,goBack:()=>B(-1),goForward:()=>B(1),block:(t="")=>{const e=A.setPrompt(t);return Y||(W(1),Y=!0),()=>(Y&&(Y=!1,W(-1)),e())},listen:t=>{const e=A.appendListener(t);return W(1),()=>{W(-1),e()}}};return F}};var O,R;class P{constructor(){this.root="/",this.historyType="browser",this.titleSuffix="",this.unsubscribe=(()=>{}),this.match=null}titleSuffixChanged(t){this.activeRouter.set({titleSuffix:t})}computeMatch(t){return{path:this.root,url:this.root,isExact:t===this.root,params:{}}}componentWillLoad(){const t=k[this.historyType]();t.listen(t=>{this.activeRouter.set({location:this.getLocation(t)})}),this.activeRouter.set({location:this.getLocation(t.location),titleSuffix:this.titleSuffix,root:this.root,history:t}),this.unsubscribe=this.activeRouter.subscribe(()=>{this.match=this.computeMatch()}),this.match=this.computeMatch()}getLocation(t){const e=0==t.pathname.indexOf(this.root)?"/"+t.pathname.slice(this.root.length):t.pathname;return Object.assign({},t,{pathname:e})}componentDidUnload(){this.unsubscribe()}render(){return t("slot",null)}static get is(){return"stencil-router"}static get properties(){return{activeRouter:{context:"activeRouter"},historyType:{type:"Any",attr:"history-type"},match:{state:!0},root:{type:String,attr:"root"},titleSuffix:{type:String,attr:"title-suffix",watchCallbacks:["titleSuffixChanged"]}}}}class L{componentWillLoad(){const t=this.activeRouter.get("history");if(t)return t.replace(this.getUrl(this.url),{})}getUrl(t){const e=this.activeRouter.get("root")||"/";return"/"==t.charAt(0)&&"/"==e.charAt(e.length-1)?e.slice(0,e.length-1)+t:e+t}static get is(){return"stencil-router-redirect"}static get properties(){return{activeRouter:{context:"activeRouter"},url:{type:String,attr:"url"}}}}const A=({children:e})=>{const n=window.stencilrouter.Context.activeRouter.createGroup(e.length),o=e.map((t,e)=>(t.vattrs.group=n,t.vattrs.groupIndex=e,t));return t("div",null,o)};const S=e=>{var{component:n}=e,o=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(t);i<o.length;i++)e.indexOf(o[i])<0&&(n[o[i]]=t[o[i]])}return n}(e,["component"]);return t("stencil-route",Object.assign({},o,{routeRender:e=>window.userAuthenticated?t(n,Object.assign({},e.componentProps)):t("stencil-router-redirect",{url:"/"})}))};class T{render(){return t("stencil-router",{"title-suffix":" - Stencil Router Demos"},t("ul",null,t("li",null,t("stencil-route-link",{url:"/",exact:!0},"Exact Base Link")),t("li",null,t("stencil-route-link",{url:"/"},"Base Link")),t("li",null,t("stencil-route-link",{url:"/demo",urlMatch:["/demo","/demox"],exact:!0},"Demo Link")),t("li",null,t("stencil-route-link",{url:"/demo2"},"Demo2 Link")),t("li",null,t("stencil-route-link",{url:"/demo3"},"Demo3 Link")),t("li",null,t("stencil-route-link",{url:"/demo3/page1"},"Demo3 Page1 Link")),t("li",null,t("stencil-route-link",{url:"/demo3/page2"},"Demo3 Page2 Link")),t("li",null,t("stencil-route-link",{url:"/demo4"},"Demo4 Link")),t("li",null,t("stencil-route-link",{url:"/demo6/"},"Demo6 Link")),t("li",null,t("stencil-route-link",{anchorTabIndex:"1",url:"/demo7/"},"Demo7 Link")),t("stencil-route-link",{custom:"li",url:"/demo8/"},"Demo8 Link")),t(A,null,t("stencil-route",{url:"/",exact:!0,routeRender:e=>t("span",null,"rendering /")}),t("stencil-route",{url:["/demo","/demox"],routeRender:e=>[t("stencil-route-title",{title:"DEMO"}),t("span",null,"rendering /demo")]}),t("stencil-route",{url:"/demo2",routeRender:e=>[t("span",null,"rendering /demo2"),t("stencil-router-redirect",{url:"/demo3"})]}),t("stencil-route",{url:"/demo3",routeRender:e=>[t("stencil-route-title",{title:"Demo 3"}),t("span",null,"rendering /demo 3")]}),t("stencil-route",{url:"/demo4",component:"test-demo-four"}),t("stencil-route",{url:"/demo5",component:"async-content",componentProps:{location:"/"}}),t("stencil-route",{url:"/demo6",component:"test-demo-six"}),t(S,{url:"/demo7",component:"test-demo-six",componentProps:{testing:!0}}),t("stencil-route",{url:"/demo8",routeRender:e=>[t("stencil-route-title",{title:"Demo 8"}),t("span",null,"rendering /demo 8")]}),t("stencil-route",{routeRender:()=>t("span",null,"The route is not found")})))}static get is(){return"test-app"}}export{e as StencilRouteTitle,P as StencilRouter,L as StencilRouterRedirect,T as TestApp};